import { assertEquals } from '@std/assert';

import event0 from '../../../fixtures/event-0.json' with { type: 'json' };

import { N64 } from './N64.ts';

Deno.test('N64', () => {
  const base64 = N64.encodeEvent(event0);
  const event = N64.decodeEvent(base64);

  assertEquals(event, event0);
});

Deno.test('N64.encodeEvent', () => {
  const base64 = N64.encodeEvent(event0);
  assertEquals(
    base64,
    'eyJpZCI6IjYzZDM4YzliNDgzZDJkOThhNDYzODJlYWRlZmQyNzJlMGU0YmRiMTA2YTViNmVkZGI0MDBjNGU3NmY2OTNkMzUiLCJwdWJrZXkiOiI3OWMyY2FlMTE0ZWEyOGE5ODFlNzU1OWI0ZmU3ODU0YTQ3MzUyMWE4ZDIyYTY2YmJhYjlmYTI0OGViODIwZmY2IiwiY3JlYXRlZF9hdCI6MTY5OTM5ODM3Niwia2luZCI6MCwidGFncyI6W1sicHJveHkiLCJodHRwczovL2dsZWFzb25hdG9yLmNvbS91c2Vycy9hbGV4IiwiYWN0aXZpdHlwdWIiXV0sImNvbnRlbnQiOiJ7XCJuYW1lXCI6XCJBbGV4IEdsZWFzb25cIixcImFib3V0XCI6XCJJIGNyZWF0ZSBGZWRpdmVyc2Ugc29mdHdhcmUgdGhhdCBlbXBvd2VycyBwZW9wbGUgb25saW5lLlxcblxcbkknbSB2ZWdhbiBidHcuXFxuXFxuTm90ZTogSWYgeW91IGhhdmUgYSBxdWVzdGlvbiBmb3IgbWUsIHBsZWFzZSB0YWcgbWUgcHVibGljbHkuIFRoaXMgZ2l2ZXMgdGhlIG9wcG9ydHVuaXR5IGZvciBvdGhlcnMgdG8gY2hpbWUgaW4sIGFuZCBieXN0YW5kZXJzIHRvIGxlYXJuLlwiLFwicGljdHVyZVwiOlwiaHR0cHM6Ly9tZWRpYS5nbGVhc29uYXRvci5jb20vYWFlMDA3MTE4ODY4MTYyOWYyMDBhYjQxNTAyZTAzYjk4NjFkMjc1NGE0NGMwMDhkMzg2OWM4YTA4YjA4ZDFmMS5wbmdcIixcImJhbm5lclwiOlwiaHR0cHM6Ly9tZWRpYS5nbGVhc29uYXRvci5jb20vZTVmNmUwZTM4MDUzNjc4MGVmYTc3NGU4ZDNjOGE1YTA0MGUzZjlmOTlkYmI0ODkxMGIyNjFjMzI4NzJlZTNhMy5naWZcIixcIm5pcDA1XCI6XCJhbGV4X2F0X2dsZWFzb25hdG9yLmNvbUBtb3N0ci5wdWJcIixcImx1ZDE2XCI6XCJhbGV4QGFsZXhnbGVhc29uLm1lXCJ9Iiwic2lnIjoiOWQ0OGJiYjYwMGFhYjQ0YWJhZWVlMTFjOTdmMTc1M2YxZDdkZTA4Mzc4ZTliMzNkODRmOWJlODkzYTA5MjcwYWVjZWVjZmRlM2NmYjY5OGM1NTVhZTFiZGUzZTRlNTRiMzQ2M2E2MWJiOTliZGY2NzNkNjRjMjIwMmY5OGIwZTkifQ==',
  );
});

Deno.test('N64.decodeEvent', () => {
  const event = N64.decodeEvent(
    'eyJpZCI6IjYzZDM4YzliNDgzZDJkOThhNDYzODJlYWRlZmQyNzJlMGU0YmRiMTA2YTViNmVkZGI0MDBjNGU3NmY2OTNkMzUiLCJwdWJrZXkiOiI3OWMyY2FlMTE0ZWEyOGE5ODFlNzU1OWI0ZmU3ODU0YTQ3MzUyMWE4ZDIyYTY2YmJhYjlmYTI0OGViODIwZmY2IiwiY3JlYXRlZF9hdCI6MTY5OTM5ODM3Niwia2luZCI6MCwidGFncyI6W1sicHJveHkiLCJodHRwczovL2dsZWFzb25hdG9yLmNvbS91c2Vycy9hbGV4IiwiYWN0aXZpdHlwdWIiXV0sImNvbnRlbnQiOiJ7XCJuYW1lXCI6XCJBbGV4IEdsZWFzb25cIixcImFib3V0XCI6XCJJIGNyZWF0ZSBGZWRpdmVyc2Ugc29mdHdhcmUgdGhhdCBlbXBvd2VycyBwZW9wbGUgb25saW5lLlxcblxcbkknbSB2ZWdhbiBidHcuXFxuXFxuTm90ZTogSWYgeW91IGhhdmUgYSBxdWVzdGlvbiBmb3IgbWUsIHBsZWFzZSB0YWcgbWUgcHVibGljbHkuIFRoaXMgZ2l2ZXMgdGhlIG9wcG9ydHVuaXR5IGZvciBvdGhlcnMgdG8gY2hpbWUgaW4sIGFuZCBieXN0YW5kZXJzIHRvIGxlYXJuLlwiLFwicGljdHVyZVwiOlwiaHR0cHM6Ly9tZWRpYS5nbGVhc29uYXRvci5jb20vYWFlMDA3MTE4ODY4MTYyOWYyMDBhYjQxNTAyZTAzYjk4NjFkMjc1NGE0NGMwMDhkMzg2OWM4YTA4YjA4ZDFmMS5wbmdcIixcImJhbm5lclwiOlwiaHR0cHM6Ly9tZWRpYS5nbGVhc29uYXRvci5jb20vZTVmNmUwZTM4MDUzNjc4MGVmYTc3NGU4ZDNjOGE1YTA0MGUzZjlmOTlkYmI0ODkxMGIyNjFjMzI4NzJlZTNhMy5naWZcIixcIm5pcDA1XCI6XCJhbGV4X2F0X2dsZWFzb25hdG9yLmNvbUBtb3N0ci5wdWJcIixcImx1ZDE2XCI6XCJhbGV4QGFsZXhnbGVhc29uLm1lXCJ9Iiwic2lnIjoiOWQ0OGJiYjYwMGFhYjQ0YWJhZWVlMTFjOTdmMTc1M2YxZDdkZTA4Mzc4ZTliMzNkODRmOWJlODkzYTA5MjcwYWVjZWVjZmRlM2NmYjY5OGM1NTVhZTFiZGUzZTRlNTRiMzQ2M2E2MWJiOTliZGY2NzNkNjRjMjIwMmY5OGIwZTkifQ==',
  );
  assertEquals(event, event0);
});
